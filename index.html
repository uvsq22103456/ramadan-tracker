<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Ramadan Sisters üåô</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // --- CONFIGURATION FIREBASE (bu-buddy) ---
        const firebaseConfig = {
            apiKey: "AIzaSyCBSj_Axhnldf2cz5hVyJaOwJWQ5c_l-Tk",
            authDomain: "bu-buddy-4bafe.firebaseapp.com",
            projectId: "bu-buddy-4bafe",
            storageBucket: "bu-buddy-4bafe.firebasestorage.app",
            messagingSenderId: "1083707246516",
            appId: "1:1083707246516:web:f8692fa38a13e38e3554e1",
            measurementId: "G-FTNXQB8NY4"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const appId = 'ramadan-sisters-final-app';

        let currentUser = null;
        let activeDayIdx = 1;
        let userData = {};
        
        // --- CODES PIN DEMAND√âS ---
        const USERS = [
            { id: 'samia', name: 'Samia', pin: '2025', color: 'bg-rose-100 text-rose-600' },
            { id: 'enora', name: 'Enora', pin: '1702', color: 'bg-blue-100 text-blue-600' },
            { id: 'kelly', name: 'Kelly', pin: '0905', color: 'bg-emerald-100 text-emerald-600' },
            { id: 'cherryl', name: 'Cherryl', pin: '1303', color: 'bg-purple-100 text-purple-600' }
        ];

        const spiritualLibrary = {
            'triste': [
                { text: "Ne t'afflige pas, car Allah est avec nous.", ref: "Sourate At-Tawbah, 9:40" },
                { text: "Certes, apr√®s la difficult√© vient la facilit√©.", ref: "Sourate Ash-Sharh, 94:5" },
                { text: "Et ton Seigneur ne t'a ni abandonn√©, ni d√©test√©.", ref: "Sourate Ad-Duha, 93:3" },
                { text: "Allah est le Protecteur de ceux qui ont la foi.", ref: "Sourate Al-Baqarah, 2:257" }
            ],
            'anxieuse': [
                { text: "N'est-ce pas par l'√©vocation d'Allah que les c≈ìurs s'apaisent ?", ref: "Sourate Ar-Ra'd, 13:28" },
                { text: "Allah ne charge aucune √¢me au-del√† de sa capacit√©.", ref: "Sourate Al-Baqarah, 2:286" },
                { text: "Invoquez-Moi, Je vous r√©pondrai.", ref: "Sourate Ghafir, 40:60" }
            ],
            'fatiguee': [
                { text: "Et cherchez secours dans l'endurance et la pri√®re.", ref: "Sourate Al-Baqarah, 2:45" },
                { text: "Tout ce qui afflige le musulman, Allah lui efface une partie de ses p√©ch√©s.", ref: "Al-Bukhari" },
                { text: "Le je√ªne est pour Moi, et c'est Moi qui en donne la r√©compense.", ref: "Hadith Qudsi" }
            ],
            'reconnaissante': [
                { text: "Si vous √™tes reconnaissants, tr√®s certainement J'augmenterai Mes bienfaits.", ref: "Sourate Ibrahim, 14:7" },
                { text: "Lequel des bienfaits de votre Seigneur nierez-vous ?", ref: "Sourate Ar-Rahman" },
                { text: "Dire 'Alhamdulillah' remplit la balance des bonnes actions.", ref: "Muslim" }
            ],
            'motivee': [
                { text: "Faites le bien ! Car Allah aime les bienfaisants.", ref: "Sourate Al-Baqarah, 2:195" },
                { text: "Les meilleures actions sont les plus r√©guli√®res.", ref: "Al-Bukhari" },
                { text: "Quiconque fait une bonne action en verra dix fois la r√©compense.", ref: "Sourate Al-An'am, 6:160" }
            ]
        };

        async function initApp() {
            try {
                const userCred = await signInAnonymously(auth);
                if (userCred.user) {
                    document.getElementById('loading-moon').classList.add('hidden');
                    renderProfileList();
                }
            } catch (error) {
                document.getElementById('error-msg').innerText = "Erreur Cloud.";
            }
        }

        async function syncData(userId) {
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'users_progress', userId);
            const docSnap = await getDoc(docRef);
            if (docSnap.exists()) { 
                userData = docSnap.data(); 
            } else {
                userData = { customRecipes: [] };
                for(let i=1; i<=30; i++) {
                    userData[i] = { fasting: false, prayers: [false,false,false,false,false], tarawih: false, tarawihNotes: "", surah: "", quranNotes: "", journal: "", water: 0, objectives: [], dhikr: 0 };
                }
                await setDoc(docRef, userData);
            }
            refreshUI();
        }

        async function pushData() {
            if (!currentUser) return;
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'users_progress', currentUser.id);
            await setDoc(docRef, userData);
        }

        // --- WINDOW FUNCTIONS ---
        window.pressKey = (n) => { 
            const d = document.getElementById('pin-display'); 
            if (d.value.length < 4) d.value += n; 
        };
        window.clearPin = () => document.getElementById('pin-display').value = "";
        window.validatePin = () => {
            const input = document.getElementById('pin-display').value;
            if (input === window.selectedLoginUser.pin) {
                window.doLogin(window.selectedLoginUser);
            } else {
                showToast("PIN incorrect !");
                window.clearPin();
            }
        };
        window.doLogin = (user) => {
            currentUser = user;
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('app-content').classList.remove('hidden');
            document.getElementById('app-nav').classList.remove('hidden');
            document.getElementById('welcome-msg').innerText = `As salam aleykoum ${user.name} ‚ú®`;
            syncData(user.id);
        };
        window.selectDay = (idx) => { activeDayIdx = idx; refreshUI(); };
        window.toggleFast = () => { userData[activeDayIdx].fasting = !userData[activeDayIdx].fasting; pushData(); refreshUI(); };
        window.togglePrayer = (i) => { 
            if(!userData[activeDayIdx].prayers) userData[activeDayIdx].prayers = [false,false,false,false,false];
            userData[activeDayIdx].prayers[i] = !userData[activeDayIdx].prayers[i]; 
            pushData(); 
            refreshUI(); 
        };
        window.toggleTarawih = () => { userData[activeDayIdx].tarawih = !userData[activeDayIdx].tarawih; pushData(); refreshUI(); };
        
        // --- WATER FIX (STYLISH) ---
        window.addWaterGlass = (amt) => { 
            userData[activeDayIdx].water = Math.max(0, (userData[activeDayIdx].water || 0) + amt); 
            document.getElementById('display-water-val').innerText = userData[activeDayIdx].water.toFixed(1);
            updateWaterIcons();
            pushData(); 
        };

        function updateWaterIcons() {
            const glassesCount = Math.floor((userData[activeDayIdx].water || 0) / 0.25);
            let html = "";
            for(let i=1; i<=10; i++) {
                const filled = i <= glassesCount;
                html += `<div class="w-8 h-10 rounded-b-lg border-2 ${filled ? 'bg-blue-400 border-blue-500 shadow-inner' : 'bg-white border-slate-200'} transition-all duration-500 relative overflow-hidden">
                    ${filled ? '<div class="absolute inset-0 bg-white/20 animate-pulse"></div>' : ''}
                </div>`;
            }
            document.getElementById('water-glasses-grid').innerHTML = html;
        }

        // --- TASBIH FIX ---
        window.addDhikr = () => { 
            if(!userData[activeDayIdx].dhikr) userData[activeDayIdx].dhikr = 0; 
            userData[activeDayIdx].dhikr++; 
            document.getElementById('display-dhikr').innerText = userData[activeDayIdx].dhikr; 
            pushData(); 
        };
        window.openResetModal = () => document.getElementById('reset-modal').classList.remove('hidden');
        window.closeResetModal = () => document.getElementById('reset-modal').classList.add('hidden');
        window.confirmResetDhikr = () => {
            userData[activeDayIdx].dhikr = 0; 
            document.getElementById('display-dhikr').innerText = "0";
            pushData();
            window.closeResetModal();
        };
        
        window.saveJournal = () => {
            userData[activeDayIdx].surah = document.getElementById('input-surah').value;
            userData[activeDayIdx].quranNotes = document.getElementById('input-quran-notes').value;
            userData[activeDayIdx].tarawihNotes = document.getElementById('input-tarawih-notes').value;
            userData[activeDayIdx].journal = document.getElementById('input-journal').value;
            pushData(); 
            showToast("Sauvegard√© ‚ú®");
        };

        window.addObjective = () => {
            const input = document.getElementById('objective-input');
            if(!input.value.trim()) return;
            if(!userData[activeDayIdx].objectives) userData[activeDayIdx].objectives = [];
            userData[activeDayIdx].objectives.push({ text: input.value.trim(), done: false });
            input.value = ""; pushData(); refreshUI();
        };
        window.toggleObjective = (i) => { userData[activeDayIdx].objectives[i].done = !userData[activeDayIdx].objectives[i].done; pushData(); refreshUI(); };
        window.removeObjective = (i) => { userData[activeDayIdx].objectives.splice(i, 1); pushData(); refreshUI(); };

        window.addManualRecipe = () => {
            const input = document.getElementById('recipe-input');
            if(!input.value.trim()) return;
            if(!userData.customRecipes) userData.customRecipes = [];
            userData.customRecipes.push(input.value.trim());
            input.value = ""; pushData(); refreshUI();
        };
        window.removeRecipe = (i) => { userData.customRecipes.splice(i, 1); pushData(); refreshUI(); };

        window.showRandomSpiritualMessage = (mood) => {
            const list = spiritualLibrary[mood];
            const randomItem = list[Math.floor(Math.random() * list.length)];
            const display = document.getElementById('mood-result-display');
            const box = document.getElementById('mood-result-box');
            box.classList.remove('hidden');
            display.innerHTML = `<div class="animate-in slide-in-from-top-2 duration-500">
                <p class="text-sm font-semibold italic text-slate-800 leading-relaxed">"${randomItem.text}"</p>
                <p class="text-[9px] text-rose-400 font-bold uppercase mt-3 tracking-widest">‚Äî ${randomItem.ref}</p>
            </div>`;
            box.scrollIntoView({ behavior: 'smooth', block: 'center' });
        };

        function renderProfileList() {
            document.getElementById('profile-grid').innerHTML = USERS.map(u => `
                <button onclick="window.initiateLogin('${u.id}')" class="bg-white p-6 rounded-[2.5rem] shadow-sm flex flex-col items-center gap-3 active:scale-95 transition">
                    <div class="w-16 h-16 rounded-full ${u.color} flex items-center justify-center text-xl font-bold shadow-sm">${u.name.charAt(0)}</div>
                    <span class="font-bold text-slate-700">${u.name}</span>
                </button>`).join('');
        }
        window.initiateLogin = (uid) => {
            window.selectedLoginUser = USERS.find(u => u.id === uid);
            document.getElementById('profile-grid').classList.add('hidden');
            document.getElementById('pin-pad').classList.remove('hidden');
            document.getElementById('pin-name').innerText = `${window.selectedLoginUser.name}`;
            window.clearPin();
        };

        function refreshUI() {
            const d = userData[activeDayIdx]; if(!d) return;
            let fasted = 0; Object.values(userData).forEach(x => { if(x && typeof x === 'object' && x.fasting) fasted++; });
            document.getElementById('stats-fast-count').innerText = fasted;

            let calHtml = "";
            for(let i=1; i<=30; i++) {
                const day = userData[i];
                const cls = `aspect-square flex items-center justify-center rounded-2xl font-bold transition ${day?.fasting ? 'bg-rose-500 text-white shadow-sm' : 'bg-white text-slate-300'} ${activeDayIdx === i ? 'ring-2 ring-rose-600 ring-offset-2' : ''}`;
                calHtml += `<button onclick="window.selectDay(${i})" class="${cls}">${i}</button>`;
            }
            document.getElementById('calendar-grid').innerHTML = calHtml;
            document.getElementById('day-title').innerText = `Jour ${activeDayIdx}`;
            
            const fBtn = document.getElementById('fast-btn');
            fBtn.innerText = d.fasting ? "OUI" : "NON";
            fBtn.className = `px-5 py-2 rounded-full text-[10px] font-black ${d.fasting ? 'bg-rose-500 text-white shadow-md' : 'bg-slate-100 text-slate-400'}`;

            const prayers = ["Fajr", "Dohr", "Asr", "Magh", "Isha"];
            document.getElementById('prayer-grid').innerHTML = prayers.map((n, i) => `
                <button onclick="window.togglePrayer(${i})" class="flex flex-col items-center gap-1">
                    <div class="w-11 h-11 rounded-2xl flex items-center justify-center ${d.prayers && d.prayers[i] ? 'bg-rose-500 text-white' : 'bg-slate-50 text-slate-200'}">
                        <i data-lucide="check" class="w-6 h-6"></i>
                    </div>
                    <span class="text-[8px] font-black uppercase text-slate-400">${n}</span>
                </button>`).join('');

            const tBtn = document.getElementById('tarawih-btn');
            tBtn.innerText = d.tarawih ? "FAIT ‚ú®" : "PAS ALL√â";
            tBtn.className = `px-5 py-2 rounded-full text-[10px] font-black ${d.tarawih ? 'bg-indigo-500 text-white shadow-md' : 'bg-slate-100 text-slate-400'}`;

            const objList = document.getElementById('objectives-list');
            objList.innerHTML = d.objectives?.length > 0 ? d.objectives.map((obj, i) => `
                <div class="flex items-center justify-between bg-slate-50 p-3 rounded-xl mb-2">
                    <div class="flex items-center gap-3">
                        <button onclick="window.toggleObjective(${i})" class="w-5 h-5 rounded-md border-2 border-rose-200 flex items-center justify-center ${obj.done ? 'bg-rose-500 border-rose-500' : ''}">
                            ${obj.done ? '<i data-lucide="check" class="w-3 h-3 text-white"></i>' : ''}
                        </button>
                        <span class="text-sm ${obj.done ? 'line-through text-slate-400' : 'text-slate-700 font-medium'}">${obj.text}</span>
                    </div>
                    <button onclick="window.removeObjective(${i})" class="text-slate-300 active:text-rose-500"><i data-lucide="x" class="w-4 h-4"></i></button>
                </div>`).join('') : '<p class="text-[10px] text-slate-400 italic py-2 text-center">Aucun objectif...</p>';

            const recipeList = document.getElementById('custom-recipes-list');
            recipeList.innerHTML = userData.customRecipes?.length > 0 ? userData.customRecipes.map((rec, i) => `
                <div class="flex items-center justify-between bg-rose-50/50 p-3 rounded-xl mb-2 border border-rose-100">
                    <span class="text-xs font-semibold text-rose-700 italic">üç¥ ${rec}</span>
                    <button onclick="window.removeRecipe(${i})" class="text-rose-300 active:text-rose-600"><i data-lucide="trash-2" class="w-3 h-3"></i></button>
                </div>`).join('') : '<p class="text-[10px] text-slate-300 italic text-center">Ton carnet est vide...</p>';

            document.getElementById('input-surah').value = d.surah || "";
            document.getElementById('input-quran-notes').value = d.quranNotes || "";
            document.getElementById('input-tarawih-notes').value = d.tarawihNotes || "";
            document.getElementById('input-journal').value = d.journal || "";
            document.getElementById('display-water-val').innerText = (d.water || 0).toFixed(1);
            updateWaterIcons();
            document.getElementById('display-dhikr').innerText = d.dhikr || 0;
            lucide.createIcons();
        }

        window.switchTab = (n) => {
            ['calendar', 'cuisine', 'dhikr', 'spiritual'].forEach(t => { 
                document.getElementById(`tab-${t}`).classList.add('hidden'); 
                document.getElementById(`nav-${t}`).classList.replace('text-rose-600', 'text-slate-300'); 
            });
            document.getElementById(`tab-${n}`).classList.remove('hidden');
            document.getElementById(`nav-${n}`).classList.replace('text-slate-300', 'text-rose-600');
            window.scrollTo(0,0);
        };
        function showToast(m) {
            const t = document.createElement('div');
            t.className = "fixed top-12 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-6 py-4 rounded-3xl text-xs font-black z-[200] animate-bounce uppercase shadow-2xl";
            t.innerText = m; document.body.appendChild(t); setTimeout(() => t.remove(), 2500);
        }
        window.logout = () => { sessionStorage.clear(); location.reload(); };
        window.onload = () => { lucide.createIcons(); initApp(); };
    </script>

    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; }
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-[#FFF9FA] text-slate-800">

    <!-- MODAL R√âINITIALISATION -->
    <div id="reset-modal" class="hidden fixed inset-0 z-[300] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-6">
        <div class="bg-white rounded-[2.5rem] p-8 w-full max-w-xs text-center shadow-2xl animate-in zoom-in duration-300">
            <div class="bg-rose-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 text-rose-500"><i data-lucide="alert-triangle"></i></div>
            <h3 class="text-lg font-black mb-2">R√©initialiser ?</h3>
            <p class="text-slate-400 text-xs mb-8">Effacer le Tasbih pour aujourd'hui ?</p>
            <div class="flex flex-col gap-2">
                <button onclick="window.confirmResetDhikr()" class="bg-rose-500 text-white py-4 rounded-2xl font-black text-xs uppercase tracking-widest shadow-lg active:scale-95 transition">Oui, √† z√©ro</button>
                <button onclick="window.closeResetModal()" class="bg-slate-100 text-slate-400 py-4 rounded-2xl font-black text-xs uppercase tracking-widest">Annuler</button>
            </div>
        </div>
    </div>

    <!-- CHARGEMENT -->
    <div id="loading-moon" class="fixed inset-0 z-[100] bg-white flex flex-col items-center justify-center p-6 text-center">
        <div class="bg-rose-50 w-24 h-24 rounded-full flex items-center justify-center animate-pulse mb-4"><i data-lucide="moon" class="text-rose-500 w-12 h-12"></i></div>
        <p class="text-slate-400 text-sm font-bold" id="error-msg">Pr√©paration de votre mois b√©ni... ‚ú®</p>
    </div>

    <!-- AUTH -->
    <div id="auth-screen" class="fixed inset-0 z-50 bg-white flex flex-col items-center justify-center p-6 text-center overflow-y-auto">
        <div class="mb-12">
            <h1 class="text-3xl font-black text-slate-900 tracking-tight">Ramadan Sisters</h1>
            <p class="text-slate-400 mt-2 text-sm italic px-6 leading-relaxed">Suivons nos progr√®s et objectifs durant ce mois b√©ni ‚ú®</p>
        </div>
        <div id="profile-grid" class="grid grid-cols-2 gap-4 w-full max-w-sm px-4"></div>
        <div id="pin-pad" class="hidden w-full max-w-xs animate-in fade-in zoom-in duration-300 px-4 text-center pb-12">
            <p class="text-rose-400 text-[10px] uppercase font-black tracking-widest mb-2">Code PIN</p>
            <h2 id="pin-name" class="text-2xl font-black mb-6 text-slate-800"></h2>
            <input type="password" id="pin-display" readonly maxlength="4" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" class="w-full text-center text-4xl tracking-[1rem] bg-rose-50 border-none rounded-2xl p-6 text-rose-600 outline-none mb-6">
            <div class="grid grid-cols-3 gap-3">
                <button onclick="window.pressKey('1')" class="bg-white p-5 rounded-2xl shadow-sm font-bold active:bg-rose-50 transition">1</button>
                <button onclick="window.pressKey('2')" class="bg-white p-5 rounded-2xl shadow-sm font-bold active:bg-rose-50 transition">2</button>
                <button onclick="window.pressKey('3')" class="bg-white p-5 rounded-2xl shadow-sm font-bold active:bg-rose-50 transition">3</button>
                <button onclick="window.pressKey('4')" class="bg-white p-5 rounded-2xl shadow-sm font-bold active:bg-rose-50 transition">4</button>
                <button onclick="window.pressKey('5')" class="bg-white p-5 rounded-2xl shadow-sm font-bold active:bg-rose-50 transition">5</button>
                <button onclick="window.pressKey('6')" class="bg-white p-5 rounded-2xl shadow-sm font-bold active:bg-rose-50 transition">6</button>
                <button onclick="window.pressKey('7')" class="bg-white p-5 rounded-2xl shadow-sm font-bold active:bg-rose-50 transition">7</button>
                <button onclick="window.pressKey('8')" class="bg-white p-5 rounded-2xl shadow-sm font-bold active:bg-rose-50 transition">8</button>
                <button onclick="window.pressKey('9')" class="bg-white p-5 rounded-2xl shadow-sm font-bold active:bg-rose-50 transition">9</button>
                <button onclick="window.clearPin()" class="bg-rose-50 text-rose-400 p-5 rounded-2xl font-black text-[10px] uppercase">Reset</button>
                <button onclick="window.pressKey('0')" class="bg-white p-5 rounded-2xl shadow-sm font-bold active:bg-rose-50 transition">0</button>
                <button onclick="window.validatePin()" class="bg-rose-500 text-white p-5 rounded-2xl font-bold shadow-md active:scale-95 transition">OK</button>
            </div>
        </div>
    </div>

    <!-- MAIN APP -->
    <main id="app-content" class="hidden min-h-screen pb-32">
        <header class="p-6 pt-12 flex justify-between items-center bg-white rounded-b-[3rem] shadow-sm mb-6 border-b border-rose-50">
            <div><h2 id="welcome-msg" class="text-xl font-bold text-slate-800">Salam !</h2><p class="text-[10px] font-bold text-rose-400 uppercase tracking-widest mt-1 italic">Compagnon de Ramadan üåô</p></div>
            <button onclick="window.logout()" class="p-3 bg-rose-50 rounded-2xl text-rose-500 active:scale-90 transition"><i data-lucide="power" class="w-6 h-6"></i></button>
        </header>

        <!-- TAB SUIVI -->
        <div id="tab-calendar" class="p-4 space-y-6">
            <section class="bg-white rounded-[2.5rem] p-6 shadow-sm">
                <div class="grid grid-cols-6 gap-2 mb-6" id="calendar-grid"></div>
                <div class="bg-rose-500 rounded-3xl p-5 text-white flex items-center justify-between shadow-lg shadow-rose-100">
                    <div><p class="text-[10px] font-bold uppercase opacity-80 tracking-widest">Ma progression</p><p class="text-2xl font-black"><span id="stats-fast-count">0</span> / 30 <span class="text-sm font-normal italic uppercase text-xs">je√ªn√©s</span></p></div>
                    <i data-lucide="star" class="w-8 h-8 opacity-40"></i>
                </div>
            </section>

            <section class="bg-white rounded-[2.5rem] p-6 shadow-sm space-y-4 border border-rose-50">
                <h4 class="font-bold flex items-center gap-2 text-rose-600 italic uppercase text-[10px] tracking-widest"><i data-lucide="list-checks" class="w-4 h-4"></i> Mes Objectifs</h4>
                <div id="objectives-list"></div>
                <div class="flex gap-2 pt-2">
                    <input type="text" id="objective-input" placeholder="Ajouter un d√©fi..." class="flex-1 bg-slate-50 border-none rounded-xl px-4 py-3 text-sm outline-none">
                    <button onclick="window.addObjective()" class="bg-rose-500 text-white p-3 rounded-xl shadow-md active:scale-95 transition"><i data-lucide="plus" class="w-5 h-5"></i></button>
                </div>
            </section>

            <section class="bg-white rounded-[2.5rem] p-6 shadow-sm space-y-6 border border-rose-50">
                <div class="flex justify-between items-center"><h4 id="day-title" class="text-xl font-black text-rose-600">Jour 1</h4><button onclick="window.toggleFast()" id="fast-btn" class="px-5 py-2 rounded-full text-[10px] font-black tracking-widest transition-all">NON</button></div>
                
                <div><span class="text-[9px] font-black uppercase text-slate-400 mb-3 block tracking-[0.2em]">Pri√®re quotidiennes</span><div class="grid grid-cols-5 gap-2" id="prayer-grid"></div></div>

                <div class="pt-4 border-t border-slate-50">
                    <div class="flex justify-between items-center mb-3"><span class="text-[9px] font-black uppercase text-indigo-400 tracking-[0.2em]">Tarawih</span><button onclick="window.toggleTarawih()" id="tarawih-btn" class="transition-all"></button></div>
                    <textarea id="input-tarawih-notes" rows="2" placeholder="Ressenti de la pri√®re..." class="w-full bg-indigo-50/30 border-none rounded-2xl p-4 text-xs outline-none focus:ring-1 focus:ring-indigo-100"></textarea>
                </div>

                <div class="space-y-3 pt-4 border-t border-slate-50">
                    <span class="text-[9px] font-black uppercase text-emerald-600 tracking-[0.2em]">Coran</span>
                    <input type="text" id="input-surah" placeholder="Nom de la sourate ?" class="w-full bg-slate-50 border-none rounded-xl p-4 text-sm outline-none">
                    <textarea id="input-quran-notes" rows="2" placeholder="Notes de lecture..." class="w-full bg-slate-50 border-none rounded-xl p-4 text-sm outline-none"></textarea>
                </div>

                <div class="space-y-3 border-t border-slate-50 pt-4">
                    <span class="text-[9px] font-black uppercase text-rose-400 tracking-[0.2em]">Journal intime</span>
                    <textarea id="input-journal" placeholder="√âtat physique et mental..." class="w-full bg-slate-50 border-none rounded-xl p-4 text-sm outline-none"></textarea>
                </div>
                <button onclick="window.saveJournal()" class="w-full bg-slate-900 text-white py-5 rounded-[2rem] font-black text-[10px] tracking-[0.2em] shadow-xl active:scale-95 transition uppercase">Sauvegarder ma journ√©e</button>
            </section>
        </div>

        <!-- TAB CUISINE -->
        <div id="tab-cuisine" class="hidden p-4 space-y-6">
            <!-- EAU STYLE -->
            <section class="bg-white rounded-[2.5rem] p-8 shadow-sm text-center border border-blue-50">
                <div class="flex items-center justify-center gap-2 text-blue-500 mb-6">
                    <i data-lucide="droplet" class="w-6 h-6 animate-bounce"></i>
                    <h3 class="text-sm font-black uppercase tracking-widest">Objectif Hydratation</h3>
                </div>
                
                <div class="text-4xl font-black text-blue-600 mb-2"><span id="display-water-val">0.0</span><span class="text-lg ml-1 opacity-50 text-blue-400">L</span></div>
                <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest mb-8">Buvez par petites gorg√©es</p>

                <div class="flex justify-center gap-2 mb-10" id="water-glasses-grid">
                    <!-- G√©n√©r√© par JS -->
                </div>

                <div class="flex gap-3">
                    <button onclick="window.addWaterGlass(0.25)" class="flex-1 bg-blue-500 text-white py-4 rounded-2xl font-black text-xs uppercase tracking-widest shadow-lg shadow-blue-100 active:scale-95 transition">Ajouter un verre</button>
                    <button onclick="window.addWaterGlass(-0.25)" class="bg-slate-100 text-slate-400 px-6 rounded-2xl font-black active:scale-95 transition">
                        <i data-lucide="minus"></i>
                    </button>
                </div>
            </section>

            <!-- CARNET DE RECETTES -->
            <section class="bg-white rounded-[2.5rem] p-6 shadow-sm space-y-4 border border-rose-50">
                <h4 class="text-[10px] font-black text-rose-500 uppercase tracking-[0.2em] italic">Mon Carnet de Recettes üìí</h4>
                <div id="custom-recipes-list" class="space-y-2"></div>
                <div class="flex gap-2 pt-2">
                    <input type="text" id="recipe-input" placeholder="Id√©e (Smoothie, Batbout...)" class="flex-1 bg-slate-50 border-none rounded-xl px-4 py-3 text-xs outline-none">
                    <button onclick="window.addManualRecipe()" class="bg-rose-500 text-white p-3 rounded-xl shadow-md active:scale-95 transition">
                        <i data-lucide="plus" class="w-4 h-4"></i>
                    </button>
                </div>
            </section>

            <section class="space-y-4">
                <h4 class="text-[10px] font-black text-slate-400 px-2 uppercase tracking-[0.2em]">Suggestions Suhoor ü•û</h4>
                <div class="grid gap-4">
                    <div class="bg-white p-5 rounded-3xl border border-rose-50 flex items-center gap-4"><span class="text-3xl">ü•£</span><div><p class="font-bold text-sm text-rose-900">Overnight Oats Chia</p><p class="text-[10px] text-slate-400 leading-tight">Avoine, lait amande et chia.</p></div></div>
                    <div class="bg-white p-5 rounded-3xl border border-rose-50 flex items-center gap-4"><span class="text-3xl">üçé</span><div><p class="font-bold text-sm text-rose-900">Porridge Pommes</p><p class="text-[10px] text-slate-400 leading-tight">Pommes caram√©lis√©es et miel.</p></div></div>
                </div>
            </section>
        </div>

        <!-- TAB SPIRITUALIT√â -->
        <div id="tab-spiritual" class="hidden p-4 space-y-6 pb-12">
            <section class="bg-white rounded-[2.5rem] p-6 shadow-sm space-y-6 text-center border border-rose-50">
                <h3 class="text-xl font-black text-rose-600 italic">Mon √âtat d'Esprit ‚ú®</h3>
                <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Clique pour un rappel</p>
                
                <div class="grid grid-cols-3 gap-3">
                    <button onclick="window.showRandomSpiritualMessage('triste')" class="bg-blue-50 p-4 rounded-2xl flex flex-col items-center gap-2 active:scale-95 transition text-blue-400 font-black text-[9px] uppercase"><span class="text-xl">üò¢</span>Triste</button>
                    <button onclick="window.showRandomSpiritualMessage('anxieuse')" class="bg-indigo-50 p-4 rounded-2xl flex flex-col items-center gap-2 active:scale-95 transition text-indigo-400 font-black text-[9px] uppercase"><span class="text-xl">üòü</span>Anxieuse</button>
                    <button onclick="window.showRandomSpiritualMessage('fatiguee')" class="bg-orange-50 p-4 rounded-2xl flex flex-col items-center gap-2 active:scale-95 transition text-orange-400 font-black text-[9px] uppercase"><span class="text-xl">üò¥</span>Fatigu√©e</button>
                    <button onclick="window.showRandomSpiritualMessage('reconnaissante')" class="bg-emerald-50 p-4 rounded-2xl flex flex-col items-center gap-2 active:scale-95 transition text-emerald-400 font-black text-[9px] uppercase"><span class="text-xl">üôè</span>Gratitude</button>
                    <button onclick="window.showRandomSpiritualMessage('motivee')" class="bg-rose-50 p-4 rounded-2xl flex flex-col items-center gap-2 active:scale-95 transition text-rose-400 font-black text-[9px] uppercase"><span class="text-xl">üöÄ</span>Motiv√©e</button>
                </div>

                <div id="mood-result-box" class="hidden animate-in fade-in slide-in-from-bottom-2 duration-300 pt-6">
                    <div class="bg-slate-50 p-6 rounded-[2.5rem] border border-rose-100 relative">
                        <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-white px-4 py-1 rounded-full border border-rose-100 text-[8px] font-black text-rose-400 uppercase tracking-widest">Un rappel pour toi... ‚ú®</div>
                        <div id="mood-result-display"></div>
                    </div>
                </div>
            </section>

            <div class="space-y-4 pt-4">
                <h4 class="text-[10px] font-black text-slate-400 px-4 uppercase tracking-[0.2em]">Motivation & Hadiths üåô</h4>
                <div class="bg-white p-6 rounded-[2.5rem] shadow-sm border-l-4 border-rose-500">
                    <p class="text-xs font-semibold text-slate-700 italic leading-relaxed">"Quiconque je√ªne le mois de Ramadan avec foi et espoir de r√©compense, ses p√©ch√©s pr√©c√©dents lui seront pardonn√©s."</p>
                    <p class="text-[9px] text-rose-400 font-bold uppercase mt-3 tracking-widest text-right">‚Äî Bukhari & Muslim</p>
                </div>
                <div class="bg-white p-6 rounded-[2.5rem] shadow-sm border-l-4 border-emerald-500">
                    <p class="text-xs font-semibold text-slate-700 italic leading-relaxed">"L'odeur de la bouche de celui qui je√ªne est plus parfum√©e aupr√®s d'Allah que l'odeur du musc."</p>
                    <p class="text-[9px] text-emerald-400 font-bold uppercase mt-3 tracking-widest text-right">‚Äî Bukhari & Muslim</p>
                </div>
                <div class="bg-white p-6 rounded-[2.5rem] shadow-sm border-l-4 border-indigo-500">
                    <p class="text-xs font-semibold text-slate-700 italic leading-relaxed">"Le je√ªne et le Coran interc√©deront pour le serviteur le Jour de la R√©surrection."</p>
                    <p class="text-[9px] text-indigo-400 font-bold uppercase mt-3 tracking-widest text-right">‚Äî Ahmad</p>
                </div>
                <div class="bg-white p-6 rounded-[2.5rem] shadow-sm border-l-4 border-blue-500">
                    <p class="text-xs font-semibold text-slate-700 italic leading-relaxed">"Il y a dans le Paradis une porte appel√©e Ar-Rayyan par laquelle seuls les je√ªneurs entreront."</p>
                    <p class="text-[9px] text-blue-400 font-bold uppercase mt-3 tracking-widest text-right">‚Äî Bukhari & Muslim</p>
                </div>
            </div>
        </div>

        <!-- TAB DHIKR -->
        <div id="tab-dhikr" class="hidden p-4 h-[70vh] flex flex-col items-center justify-center text-center">
            <div id="display-dhikr" class="text-[10rem] font-black text-rose-500 leading-none mb-10 tracking-tighter transition-all">0</div>
            <button onclick="window.addDhikr()" class="w-64 h-64 bg-rose-500 rounded-full shadow-2xl border-[15px] border-white active:scale-90 transition-all flex items-center justify-center text-white font-black text-3xl uppercase tracking-widest">Clic</button>
            <button onclick="window.openResetModal()" class="mt-12 text-slate-300 font-bold text-[10px] uppercase tracking-widest active:text-rose-500 transition-all flex items-center gap-2 mx-auto"><i data-lucide="rotate-ccw" class="w-3 h-3"></i> R√©initialiser</button>
        </div>
    </main>

    <!-- NAVIGATION -->
    <nav id="app-nav" class="hidden fixed bottom-0 left-0 right-0 glass border-t flex justify-around p-4 pb-12 z-40">
        <button onclick="window.switchTab('calendar')" id="nav-calendar" class="flex flex-col items-center gap-1 text-rose-600"><i data-lucide="calendar"></i><span class="text-[9px] font-black uppercase tracking-tight">Suivi</span></button>
        <button onclick="window.switchTab('cuisine')" id="nav-cuisine" class="flex flex-col items-center gap-1 text-slate-300"><i data-lucide="coffee"></i><span class="text-[9px] font-black uppercase tracking-tight">Cuisine</span></button>
        <button onclick="window.switchTab('dhikr')" id="nav-dhikr" class="flex flex-col items-center gap-1 text-slate-300"><i data-lucide="hash"></i><span class="text-[9px] font-black uppercase tracking-tight">Dhikr</span></button>
        <button onclick="window.switchTab('spiritual')" id="nav-spiritual" class="flex flex-col items-center gap-1 text-slate-300"><i data-lucide="sparkles"></i><span class="text-[9px] font-black uppercase tracking-tight">C≈ìur</span></button>
    </nav>

    <script>lucide.createIcons();</script>
</body>
</html>
